---
import BaseLayout from '../layouts/BaseLayout.astro';
import Timeline from '../components/Timeline.astro';
import ProjectBlock from '../components/ProjectBlock.astro';
import { getCollection } from 'astro:content';

const projects = (await getCollection('projects'))
  .sort((a, b) => new Date(b.data.date).getTime() - new Date(a.data.date).getTime());
---

<BaseLayout title="dago / portfolio">
  <Timeline>
    {projects.map(async (project) => {
      const { Content } = await project.render();
      return (
        <ProjectBlock
          title={project.data.title}
          date={project.data.date.toISOString()}
          stack={project.data.stack}
          screenshots={project.data.screens}
        >
          <Content />
        </ProjectBlock>
      )
    })}
  </Timeline>
</BaseLayout>
